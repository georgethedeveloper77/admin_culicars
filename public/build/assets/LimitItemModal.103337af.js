import"https://checkout.razorpay.com/v1/checkout.js";import X from"./PsModal.36ad7f82.js";import ee from"./PsLabel.c51f2c9d.js";import te from"./PsButton.7f6705bd.js";import oe from"./PsRadio.f6d8aed7.js";import ae from"./PsRadio2.98dcf3c7.js";import ne from"./PsErrorDialog.d6a4d7d4.js";import le from"./PsWarningDialog2.d21753d8.js";import ie from"./PsIcon.515a10c8.js";import re from"./StripePaymentModal.022f3c2c.js";import se from"./PaypalPaymentModal.94b75095.js";import pe from"./OfflinePaymentModal.1451bedc.js";import me from"./InputEmailModal.bb19c10c.js";import{u as de}from"./AppInfoStore.f8d22516.js";import{P as ce}from"./PsValueStore.eb9430a0.js";import{u as fe}from"./UserStore.cc6d36cc.js";import{u as ue}from"./PackageStore.d9f1e82f.js";import{I as _e}from"./ItemLimitParameterHolder.6c72602a.js";import{A as ye}from"./AppInfoParameterHolder.e24d894d.js";import{u as ge}from"./LimitAdItemStore.a2d7603c.js";import{c as W}from"./PsApiService.9afc2356.js";import{d as Pe,i as c,o as P,c as j,b as r,w as a,a as k,f as E,q as m,t as l,g as M,F as ke,s as Ae,A as N,r as f}from"./app.2982e019.js";import{P as L}from"./ps_constants.0e2a11f9.js";import{w as G}from"./inline.9a6c94f8.js";import{P as T}from"./PsUtils.bbfda905.js";import{f as Ie}from"./format.min.73c0dc2e.js";import{_ as Se}from"./plugin-vue_export-helper.21dcd24c.js";import"./vue-neat-modal.2bf17e6b.js";import"./PsLine.ea3266c0.js";import"./ThemeStore.40343845.js";import"./LanguageStore.8f1cddd7.js";import"./PsLabelTitle.ddb6fa87.js";import"./stripe.esm.8fdd5063.js";import"./PsLabelHeader4.c12a3123.js";import"./PsLoadingDialog.9b6db1c6.js";import"./TokenStore.3c99c57f.js";import"./ApiStatus.5720ba0b.js";import"./PsObject.a17ef38f.js";import"./PsSepetetedStore.9a31ac47.js";import"./dropin.482cf9a5.js";import"./PsLabelTitle3.30d5e369.js";import"./PsLabelHeader6.b8d308a8.js";import"./OfflinePaymentStore.27da84e5.js";import"./DefaultIcon.e76b39a5.js";import"./PsInput.5d0c1579.js";import"./DefaultPhoto.cc755f93.js";import"./User.0c3ba1a8.js";import"./RatingDetail.291ad5d1.js";import"./ProductRelation.0b376978.js";import"./UserListParameterHolder.d110b747.js";import"./Package.5254ef20.js";import"./PaymentInfo.5aa268a0.js";import"./LimitAdTransaction.68a62e95.js";const ve=Pe({name:"LimitItemModal",components:{PsModal:X,PsIcon:ie,PsLabel:ee,PsButton:te,PsErrorDialog:ne,PsRadio2:ae,PsRadio:oe,StripePaymentModal:re,PaypalPaymentModal:se,OfflinePaymentModal:pe,PsWarningDialog2:le,InputEmailModal:me},setup(){const e=c(),o=c(),x=c(),z=c(),O=c(),H=c(),u=c(),_=c(),y=ue(),A=ge(),g=new _e,i=de(),B=new ye,R=fe(),I=ce().getLoginUserId(),Y=c(0),n=c(""),s=c("");async function v(){e.value.toggle(!0),await A.resetPaidAdItemList(I),await y.resetPackageList(I),b();const t=await i.loadAppInfo(B);n.value=t.data.razorKey,t.status==W.SUCCESS?Y.value=parseInt(t.data.oneDay,10):Y.value=0}function b(){y.packageList!=null&&y.packageList.data!=null&&y.packageList.data.length>0&&(_.value=y.packageList.data[0])}function h(t){if(_.value==null||_.value.paymentInfo==null){O.value.openModal("",$t("select_package"));return}i.appInfo.data.mobileSetting.is_demo_for_payment==1?u.value.openModal(N("payment__warning_title"),N("payment__confirm_message"),N("payment__ok"),N("credit_card_modal__cancel"),()=>{t=="PAYPAL"?F():t=="STRIPE"?C():t=="RAZOR"?V():t=="PAYSTACK"?K():t=="OFFLINE"&&U()},()=>{T.log("Cancel")}):t=="PAYPAL"?F():t=="STRIPE"?C():t=="RAZOR"?V():t=="PAYSTACK"?K():t=="OFFLINE"&&U()}function C(){e.value.toggle(!1),o.value.openModal(()=>{const t=L.PAYMENT_STRIPE_METHOD.toString();w(t)},()=>{T.log("Cancel")})}async function w(t){var d;g.userId=I,g.packageId=(d=_.value.paymentInfo)==null?void 0:d.id,g.paymentMethod=t,g.paymentMethodNounce=localStorage.paymentNonce||"",g.price=_.value.paymentAttributes.price,g.razorId=s.value||"";const p=await y.postPackageBought(I,g);e.value.toggle(!1),p.status==W.ERROR?O.value.openModal("",y.limititem.message):(localStorage.paymentNonce="",location.reload())}function F(){e.value.toggle(!1),x.value.openModal(()=>{const t=L.PAYMENT_PAYPAL_METHOD.toString();w(t)},()=>{T.log("Cancel")})}async function V(){const p=(await R.loadUser(I)).data,d={key:n.value,name:"Test Company",prefill:{email:p.userEmail,name:p.userName,contact:p.userPhone},theme:{color:"#0e9f6e"},handler:async function($){s.value=$.razorpay_payment_id,w(L.PAYMENT_RAZOR_METHOD.toString())}},S=new window.Razorpay(d);S.open(),S.on("payment.failed",function($){})}async function K(){var S;const p=(await R.loadUser(I)).data;let d=p.userEmail;p.userEmail==""||p.userEmail==null?H.value.openModal($=>{var q;d=$,G.setup({key:(q=i==null?void 0:i.appInfo)==null?void 0:q.data.payStackKey,email:d,amount:_.value.price,callback:async function(Q){T.log(Q),w(L.PAYMENT_PAY_STACK_METHOD.toString())},onClose:function(){}}).openIframe()},()=>{console.log("cancel")}):G.setup({key:(S=i==null?void 0:i.appInfo)==null?void 0:S.data.payStackKey,email:d,amount:_.value.paymentAttributes.price,callback:async function(Z){T.log(Z),w(L.PAYMENT_PAY_STACK_METHOD.toString())},onClose:function(){}}).openIframe()}function U(){e.value.toggle(!1),z.value.openModal(()=>{const t=L.PAYMENT_OFFLINE_METHOD.toString();w(t)},()=>{T.log("Cancel")})}function J(t){var p,d,S;return t.toString()=="0"?N("item_price__free"):Ie((S=(d=(p=i==null?void 0:i.appInfo)==null?void 0:p.data)==null?void 0:d.mobileSetting)==null?void 0:S.price_format,t)}return{psmodal:e,openModal:v,packageprovider:y,appInfoStore:i,limitProvider:A,ps_error_dialog:O,stripe_payment_modal:o,paypal_payment_modal:x,offline_payment_modal:z,selected:_,ps_warning_dialog:u,paymentClicked:h,input_email:H,formatPrice:J}}}),be={class:"flex justify-between items-start"},Ce={class:"flex flex-wrap"},Ee={class:"flex flex-col mt-6 sm:mt-7"},we={class:""},Me={class:"flex flex-col w-full"},Le={class:"flex flex-col w-full mt-6 gap-2 sm:gap-4",id:"r1"},Te={class:"font-light"},he={class:"grid grid-cols-2 sm:grid-cols-4 gap-4 mt-6"};function $e(e,o,x,z,O,H){const u=f("ps-label"),_=f("ps-icon"),y=f("ps-radio-2"),A=f("ps-button"),g=f("ps-modal"),i=f("stripe-payment-modal"),B=f("paypal-payment-modal"),R=f("ps-warning-dialog-2"),D=f("offline-payment-modal"),I=f("ps-error-dialog"),Y=f("input-email-modal");return P(),j("div",null,[r(g,{ref:"psmodal",line:"hidden",maxWidth:"534px",isClickOut:!1,class:"h-full",bodyHeight:"max-h-72",theme:"px-4 py-8 sm:p-8 rounded-lg"},{title:a(()=>{var n,s,v,b;return[k("div",be,[((n=e.limitProvider.buyadList)==null?void 0:n.data)!=null&&((b=(v=(s=e.limitProvider.buyadList)==null?void 0:s.data[0])==null?void 0:v.user)==null?void 0:b.remainingPost)==0?(P(),E(u,{key:0,textColor:"text-lg font-semibold text-feSecondary-800 mb-2"},{default:a(()=>[m(l(e.$t("limit_item_modal__quota_running_out.")),1)]),_:1})):M("",!0),k("div",Ce,[r(u,{class:"text-lg font-semibold text-feSecondary-800 me-2"},{default:a(()=>[m(l(e.$t("limit_item_modal__limit")),1)]),_:1}),r(u,{class:"text-lg"},{default:a(()=>[m(l(e.$t("limit_item_modal__limit_post_buy")),1)]),_:1})]),r(_,{class:"cursor-pointer dark:text-feSecondary-500",name:"close",w:"24",h:"24",onClick:o[0]||(o[0]=h=>e.psmodal.toggle(!1))})])]}),body:a(()=>[k("div",Ee,[k("div",we,[k("div",Me,[r(u,{class:"font-medium text-base"},{default:a(()=>[m(l(e.$t("promote_item_modal__choose_package")),1)]),_:1}),k("div",Le,[(P(!0),j(ke,null,Ae(e.packageprovider.packageList.data,n=>(P(),E(y,{class:"",key:n.packageId,value:n,selectedValue:e.selected,"onUpdate:selectedValue":o[1]||(o[1]=s=>e.selected=s)},{title:a(()=>[k("div",null,[r(u,{class:"ms-2 text-sm text-feSecondary-800"},{default:a(()=>[m(l(n.paymentInfo.value)+" - "+l(n.paymentAttributes.count)+" "+l(e.$t("limit_item_modal__post")),1)]),_:2},1024)])]),price:a(()=>[r(u,{class:"font-semibold text-base"},{default:a(()=>{var s;return[k("span",Te,l((s=n.paymentAttributes)==null?void 0:s.currencySymbol),1),m(" "+l(e.formatPrice(n.paymentAttributes.price)),1)]}),_:2},1024)]),_:2},1032,["value","selectedValue"]))),128))])])])])]),footer:a(()=>{var n,s,v,b,h;return[r(u,{class:"mt-6 sm:mt-7 font-medium text-base"},{default:a(()=>[m(l(e.$t("promote_item_modal__pay_with")),1)]),_:1}),k("div",he,[((n=e.appInfoStore.appInfo.data)==null?void 0:n.paypalEnable)=="1"?(P(),E(A,{key:0,colors:"bg-feBrand-paypal text-feAchromatic-50",class:"",padding:"px-8 py-4",rounded:"rounded-lg",onClick:o[2]||(o[2]=C=>e.paymentClicked("PAYPAL"))},{default:a(()=>[m(l(e.$t("promote_item_modal__pay_with_paypal")),1)]),_:1})):M("",!0),((s=e.appInfoStore.appInfo.data)==null?void 0:s.stripeEnable)=="1"?(P(),E(A,{key:1,colors:"bg-feBrand-stripe text-feAchromatic-50",class:"",padding:"px-8 py-4",rounded:"rounded-lg",onClick:o[3]||(o[3]=C=>e.paymentClicked("STRIPE"))},{default:a(()=>[m(l(e.$t("promote_item_modal__pay_with_stripe")),1)]),_:1})):M("",!0),((v=e.appInfoStore.appInfo.data)==null?void 0:v.razorEnable)=="1"?(P(),E(A,{key:2,colors:"bg-feBrand-razor text-feAchromatic-50",class:"",padding:"px-8 py-4",rounded:"rounded-lg",onClick:o[4]||(o[4]=C=>e.paymentClicked("RAZOR"))},{default:a(()=>[m(l(e.$t("promote_item_modal__pay_with_razor")),1)]),_:1})):M("",!0),((b=e.appInfoStore.appInfo.data)==null?void 0:b.payStackEnabled)=="1"?(P(),E(A,{key:3,colors:"bg-feBrand-paystack text-feAchromatic-50",class:"",padding:"px-8 py-4",rounded:"rounded-lg",onClick:o[5]||(o[5]=C=>e.paymentClicked("PAYSTACK"))},{default:a(()=>[m(l(e.$t("promote_item_modal__pay_with_stack")),1)]),_:1})):M("",!0),((h=e.appInfoStore.appInfo.data)==null?void 0:h.offlineEnabled)=="1"?(P(),E(A,{key:4,class:"",padding:"px-8 py-4",rounded:"rounded-lg",onClick:o[6]||(o[6]=C=>e.paymentClicked("OFFLINE"))},{default:a(()=>[m(l(e.$t("promote_item_modal__pay_with_offline")),1)]),_:1})):M("",!0)])]}),_:1},512),r(i,{ref:"stripe_payment_modal"},null,512),r(B,{ref:"paypal_payment_modal"},null,512),r(R,{ref:"ps_warning_dialog"},null,512),r(D,{ref:"offline_payment_modal"},null,512),r(I,{ref:"ps_error_dialog"},null,512),r(Y,{ref:"input_email"},null,512)])}var Nt=Se(ve,[["render",$e]]);export{Nt as default};
