import{f as l}from"./index.esm.8fcef60c.js";import"./index.esm.7ce161a7.js";import _ from"./PsLabel.c51f2c9d.js";import{u as h}from"./ProductStore.a3320c3f.js";import{P as x}from"./PsValueStore.eb9430a0.js";import{P as m}from"./ps_constants.0e2a11f9.js";import{B as r,o as b,c as w,a as s,b as d,w as f,q as g,t as u,g as y,r as M}from"./app.2982e019.js";import{u as S,U}from"./UserUnReadMessageParameterHolder.81a68b74.js";import{_ as v}from"./plugin-vue_export-helper.21dcd24c.js";import"./ProductParameterHolder.4354be0b.js";import"./Phone.45f97258.js";import"./PsObject.a17ef38f.js";import"./PsApiService.9afc2356.js";import"./Product.29c94914.js";import"./DefaultPhoto.cc755f93.js";import"./Category.7c65464b.js";import"./DefaultIcon.e76b39a5.js";import"./SubCategory.1b4176e0.js";import"./ItemCurrency.91c8ce91.js";import"./ItemLocation.d1b92a80.js";import"./ProductRelation.0b376978.js";import"./User.0c3ba1a8.js";import"./RatingDetail.291ad5d1.js";import"./Vendor.d946ee87.js";import"./ApiStatus.5720ba0b.js";import"./UserDeleteItemParameterHolder.5d816aba.js";import"./PsSepetetedStore.9a31ac47.js";const P={name:"PsNotificationBox",components:{PsLabel:_},setup(){const e=S(),t=new U;return t.userId=localStorage.loginUserId,{userunreadmsgStore:e,userUnreadHolder:t}},data(){return{title:"Test",subject:"Test",flag:"Test",messaging:l.messaging.isSupported()?l.messaging():null,currentMessage:"Test",requireInteraction:!0,notify:!1}},methods:{closed(){this.notify=!1},async clicked(e){if((e=="approval"||e=="verify_blue_mark")&&r.get(route("fe_profile")),e=="follow"&&r.get(route("fe_follower_list"),{userId:localStorage.loginUserId}),e=="fe_broadcast"&&r.get(route("fe_notification_list")),e=="review"&&r.get(route("fe_review_list"),{user_id:localStorage.loginUserId}),e=="chat"||e=="bought"){const t=h(),n=x().getLoginUserId(),o=this.currentMessage.data.item_id;await t.loadItem(o,n);let i=m.CHAT_FROM_BUYER.toString();n==this.currentMessage.data.buyer_id&&(i=m.CHAT_FROM_SELLER.toString()),r.get(route("fe_chat"),{buyer_user_id:this.currentMessage.data.buyer_id,seller_user_id:this.currentMessage.data.seller_id,item_id:this.currentMessage.data.item_id,chat_flag:i})}e=="subscribe"&&r.get(route("fe_item_detail"),{item_id:this.currentMessage.data.item_id})},receiveMessage(){try{if(!this.messaging)return;this.messaging.onMessage(async e=>{this.currentMessage=e,console.log("Message received. ",this.currentMessag),await this.userunreadmsgStore.postUserUnreadMessageCount(this.userUnreadHolder),this.setNotificationBoxForm(e.notification.title,e.notification.body,e.data.flag),this.notify=!0,setTimeout(()=>{this.notify=!1},1e4)})}catch(e){console.log(e)}},setNotificationBoxForm(e,t,a){this.title=e,this.subject=t,this.flag=a}},created(){this.receiveMessage()}},k={key:0},B={id:"notification-box",class:"overflow-hidden flex items-end w-mobile sm:w-median lg:w-64 justify-between leading-none bg-fePrimary-000 dark:bg-feAchromatic-900 rounded-t-xl lg:rounded-t-2xl top-0 fixed"},C={class:"me-2 w-8 sm:w-10 my-auto"},I=["src"],N={class:"ms-2 mt-1 text-sm flex-grow"},T={class:"flex"};function V(e,t,a,n,o,i){const c=M("ps-label");return o.notify?(b(),w("div",k,[s("div",B,[s("a",{href:"#",id:"notification-close",onClick:t[0]||(t[0]=p=>i.closed()),title:"close"},"x"),s("div",{class:"bg-fePrimary-000 lg:px-2 py-1 px-1 h-18 cursor-pointer flex-grow flex flex-row items-center no-underline text-feAchromatic-900",onClick:t[1]||(t[1]=p=>i.clicked(o.flag))},[s("div",C,[s("img",{alt:"Placeholder",class:"rounded-md w-auto sm:h-10 h-8 cursor-pointer object-cover",width:"50px",height:"50px",src:e.$page.props.thumb1xUrl+"/"+e.$page.props.backendLogo.img_path},null,8,I)]),s("p",N,[s("span",T,[d(c,{class:"truncate lg:text-sm text-xs font-medium"},{default:f(()=>[g(u(o.title),1)]),_:1})]),d(c,{class:"font-medium text-xxs lg:text-xs",textColor:"text-feSecondary-400 dark:text-feAchromatic-500"},{default:f(()=>[g(u(o.subject),1)]),_:1})])])])])):y("",!0)}var ne=v(P,[["render",V]]);export{ne as default};
