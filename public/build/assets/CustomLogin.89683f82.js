import{d as $,Z as M,p as E,i as v,j as I,c as C,b as a,a as f,w as i,n as F,F as B,ab as W,r as n,o as T,q as m,t as l,h as j,g as U,f as x}from"./app.2982e019.js";import A from"./PsLabelHeader3.f46ed4f5.js";import O from"./PsLabelHeader5.9605c64b.js";import{P as R}from"./PsCard.1a3f6d6f.js";import{u as K}from"./Validators.f69d3a03.js";import N from"./PsInput.5d0c1579.js";import{P as q}from"./PsInputWithRightIcon.b34d7fa0.js";import z from"./PsLabel.c51f2c9d.js";import V from"./PsButton.7f6705bd.js";import{P as G}from"./PsIcon.e7a5adcd.js";import{P as J}from"./PsCheckboxValue.a24aa2fd.js";import Z from"./PsLabelCaption.54d4aa23.js";import Q from"./PsLabelTitle.ddb6fa87.js";import X from"./PsLabelTitle3.30d5e369.js";import{P as Y}from"./PsLoading.0a981307.js";import{f as g}from"./index.esm.8fcef60c.js";import"./index.esm.7ce161a7.js";import{u as ee}from"./AuthStore.abfd19f8.js";import{g as D}from"./psApiService.af14fd5e.js";import oe from"./PsFrontendLayout.69775a00.js";import{U as re}from"./UserCreateParameterHolder.d34d17bc.js";import{u as te}from"./ThemeStore.40343845.js";import{_ as se}from"./plugin-vue_export-helper.21dcd24c.js";import"./Icons.c01eddd9.js";import"./PsLabel.8e7b338e.js";import"./auth.esm.be6b9a90.js";import"./PsApiService.9afc2356.js";import"./ApiStatus.5720ba0b.js";import"./PsObject.a17ef38f.js";import"./User.0c3ba1a8.js";import"./RatingDetail.291ad5d1.js";import"./ProductRelation.0b376978.js";import"./FooterView.722f89eb.js";import"./FooterLinkSection.2922917e.js";import"./PsLink.7aa92bdc.js";import"./PsRouteLink.c57ebe2e.js";import"./PsIcon.515a10c8.js";import"./ProductParameterHolder.4354be0b.js";import"./ps_constants.0e2a11f9.js";import"./PsValueStore.eb9430a0.js";import"./AppInfoStore.f8d22516.js";import"./DefaultPhoto.cc755f93.js";import"./CustomFieldStore.79b51a65.js";import"./PsStore.6f734180.js";import"./PsSepetetedStore.9a31ac47.js";import"./PsNavTabBar.a1e78a20.js";import"./PsDropdown.2a6cc373.js";import"./PsDropdownSelect.ce61e1c2.js";import"./PsIconToggle.e81615f0.js";import"./PsInputWithLeftIcon.f3f18e1b.js";import"./ItemLocationTownshipStore.fe0ada29.js";import"./ItemLocation.d1b92a80.js";import"./LocationParameterHolder.9e411c2e.js";import"./PsUtils.bbfda905.js";import"./AppInfoParameterHolder.e24d894d.js";import"./LanguageStore.8f1cddd7.js";import"./PsNavBar.15a584b5.js";import"./UserStore.cc6d36cc.js";import"./UserListParameterHolder.d110b747.js";import"./UserUnReadMessageParameterHolder.81a68b74.js";import"./AddToCartStore.71386b4c.js";import"./PsLine.ea3266c0.js";import"./PsNotificationBox.7fffda98.js";import"./ProductStore.a3320c3f.js";import"./Phone.45f97258.js";import"./Product.29c94914.js";import"./Category.7c65464b.js";import"./DefaultIcon.e76b39a5.js";import"./SubCategory.1b4176e0.js";import"./ItemCurrency.91c8ce91.js";import"./Vendor.d946ee87.js";import"./UserDeleteItemParameterHolder.5d816aba.js";import"./NotificationStore.cd066252.js";import"https://unpkg.com/delayed-scroll-restoration-polyfill@0.1.1/index.js";import"./NotificationStore.af68b63a.js";import"./NotiUnRegisterHolder.eefb692e.js";const ae=$({components:{Head:M,Link:E,PsLabelHeader3:A,PsCard:R,PsInput:N,PsInputWithRightIcon:q,PsLabel:z,PsButton:V,PsIcon:G,PsCheckboxValue:J,PsLabelCaption:Z,PsLabelTitle:Q,PsLoading:Y,PsLabelTitle3:X,getExistUser:D,PsLabelHeader5:O},props:{canResetPassword:Boolean,status:String,error:String,errors:Object,backendSetting:Object,userLoginData:Object,firebaseConfig:String,webPushKey:String,appUrl:String,tokenForFCM:String},layout:oe,data(e){var o;return{form:this.$inertia.form({email:(o=e.userLoginData)==null?void 0:o.email,password:"",remember:!1,deviceToken:"",headerToken:"",loginMethod:e.userLoginData.loginMethod,google_id:e.userLoginData.google_id,facebook_id:e.userLoginData.facebook_id,apple_id:e.userLoginData.apple_id,profile_photo_url:e.userLoginData.profile_photo_url,name:e.userLoginData.name,registerForm:1,registerMethod:e.userLoginData.registerMethod,newUser:{username:e.userLoginData.username,password:""},user_phone:e.userLoginData.user_phone,phone_id:e.userLoginData.phone_id}),errors:{email:"",password:""}}},setup(e){const o=new re,p=v(),_=v(),H=v(!0),b=te(),k=ee(),w=JSON.parse(e.firebaseConfig);g.apps.length<1&&g.initializeApp(w);const d=g.messaging.isSupported()?g.messaging():null;d&&Notification.requestPermission().then(r=>{console.log(r==="granted"?"Notification permission granted.":"Unable to get permission to notify.")});async function u(r,s){d&&await W.post(route("firebase.topicSubscribeForNoti"),{token:r,topic:s}).then(function(t){console.log("Subscribed to "+s+".Status Code is "+t.status)}).catch(function(t){console.log(t)})}I(async()=>{if(b.initDarkMode(),"serviceWorker"in navigator){if(d){let r=e.appUrl,s=r+"/firebase-messaging-sw.js";r.endsWith("/")&&(s=r+"firebase-messaging-sw.js"),navigator.serviceWorker.register(s).then(function(t){d.getToken({vapidKey:e.webPushKey,serviceWorkerRegistration:t}).then(h=>{h&&(console.log("current token for client: ",h),localStorage.deviceToken=h,u(h,"fe_broadcast"))}).catch(h=>{console.log("An error occurred while retrieving token. ",h),localStorage.deviceToken="errorToken"})}).catch(function(t){localStorage.deviceToken="errorToken",console.log("Service worker registration failed, error:",t)})}}else localStorage.deviceToken="errorToken",console.log("no serviceWorker in navigator")});const{isEmpty:c,minLength:S,isEmail:y}=K();return{validateEmptyInput:(r,s)=>{e.errors[r]=s?S(r,s,4):c(r,s),r=="password"&&(_.value.isError=e.errors.password!="")},validateEmailInput:(r,s)=>{e.errors[r]=s?y(r,s):c(r,s),r=="email"&&(p.value.isError=e.errors.email!="")},email:p,password:_,isHide:H,authStore:k,paramHolder:o,themeStore:b}},methods:{async submit(){this.form.deviceToken=localStorage.deviceToken;const e=new Date;localStorage.headerToken=localStorage.deviceToken+e.getTime(),this.form.headerToken=localStorage.headerToken,this.form.password=this.form.newUser.password,this.paramHolder.username=this.form.newUser.username,this.paramHolder.password=this.form.newUser.password,this.paramHolder.google_id=this.form.google_id,this.paramHolder.facebook_id=this.form.facebook_id,this.paramHolder.apple_id=this.form.apple_id,this.form.loginMethod=="phone"?this.paramHolder.name=this.userLoginData.displayName:this.paramHolder.name=this.form.name?this.form.name:this.form.username,this.paramHolder.email=this.form.email,this.paramHolder.profile_photo_url=this.form.profile_photo_url?this.form.profile_photo_url:"",this.paramHolder.registerForm=this.form.registerForm,this.paramHolder.loginMethod=this.form.loginMethod,this.paramHolder.user_phone=this.form.user_phone,this.paramHolder.phone_id=this.form.phone_id;const o=await this.authStore.createUserwithUsername(this.paramHolder);o.data.status=="error"&&(this.errors.email="",this.errors.password="",this.errors.email=o.data.message.username[0],this.errors.password=o.data.message.password[0]),o.data.status=="success"&&(this.form.loginMethod=="phone"&&(this.form.email=this.form.user_phone.replace("-","")),this.form.loginMethod="normal",this.form.transform(p=>({...p,remember:this.form.remember?"on":""})).post(this.route("login"),{onFinish:()=>this.form.reset("password")}))},async getCategoriesData(e){category_loadmore_visible.value=!0,is_loading.value=!0,D(e).then(o=>{this.form.newUser=o.data})},async googleloginclicked(){const e=await this.authStore.loginWithGoogleId();this.form.deviceToken=localStorage.deviceToken;const o=new Date;localStorage.headerToken=localStorage.deviceToken+o.getTime(),this.form.headerToken=localStorage.headerToken,this.form.email=e.email,this.form.password="admin123",this.form.loginMethod="google",this.form.google_id=e.uid,this.form.name=e.displayName,this.form.profile_photo_url=e.photoURL,this.form.transform(p=>({...p})).post(this.route("createUser"),{onFinish:()=>this.form.reset("password")})},handleReset(){this.$inertia.get(route("password.request"))}}}),ie={class:"flex flex-col items-center min-h-screen pt-6 lg:mt-36 mt-28 sm:pt-0 dark:bg-feAchromatic-900 dark:text-feSecondary-50"},ne={class:"px-6"},me={key:0,class:"mb-4"},le={class:"mb-4"},de={class:"mb-8"},pe={class:"block mt-4"};function fe(e,o,p,_,H,b){const k=n("Head"),w=n("ps-label-header-5"),d=n("ps-label"),u=n("ps-input"),c=n("ps-label-caption"),S=n("ps-label-title-3"),y=n("ps-icon"),L=n("ps-input-with-right-icon"),P=n("ps-loading"),r=n("ps-button"),s=n("ps-card");return T(),C(B,null,[a(k,{title:e.$t("core__fe_sign_in")},null,8,["title"]),f("div",{class:F(e.themeStore.isDarkMode?"dark":"")},[f("div",ie,[a(s,{class:"w-full py-4 mt-6 sm:max-w-md dark:bg-feSecondary-800"},{default:i(()=>[f("div",ne,[a(w,{class:"pt-2 font-semibold text-center"},{default:i(()=>[m(l(e.$t("core_fe_create_account")),1)]),_:1}),f("form",{class:"mt-6",onSubmit:o[6]||(o[6]=j((...t)=>e.submit&&e.submit(...t),["prevent"]))},[e.userLoginData.loginMethod=="phone"?(T(),C("div",me,[a(d,{class:"mb-2",textColor:"text-feSecondary-800 dark:text-feSecondary-200"},{default:i(()=>[m(l(e.$t("core__fe_user_phone")),1)]),_:1}),a(u,{ref:"phone",type:"text",value:e.form.user_phone,"onUpdate:value":o[0]||(o[0]=t=>e.form.user_phone=t),class:"placeholder-feSecondary-800 dark:placeholder-feSecondary-500",theme:"text-feSecondary-500 dark:bg-feSecondary-800",defaultBorder:"border border-feSecondary-200 dark:border-feSecondary-400 focus:outline-none focus:ring-1 focus:ring-fePrimary-500",placeholder:e.$t("core__fe_phone_placeholder"),disabled:!0},null,8,["value","placeholder"]),a(c,{textColor:"text-feError-500 ",class:"block mt-2"},{default:i(()=>[m(l(e.errors.phone),1)]),_:1})])):U("",!0),f("div",le,[a(d,{class:"mb-2",textColor:"text-feSecondary-800 dark:text-feSecondary-200"},{default:i(()=>[m(l(e.$t("core__fe_username")),1)]),_:1}),a(u,{ref:"email",type:"text",value:e.form.newUser.username,"onUpdate:value":o[1]||(o[1]=t=>e.form.newUser.username=t),class:"placeholder-feSecondary-800 dark:placeholder-feSecondary-500",theme:"text-feSecondary-500 dark:bg-feSecondary-800",defaultBorder:"border border-feSecondary-200 dark:border-feSecondary-400 focus:outline-none focus:ring-1 focus:ring-fePrimary-500",placeholder:e.$t("core__fe_username_placeholder"),autofocus:""},null,8,["value","placeholder"]),a(S,{class:"mt-2",textColor:"text-feSecondary-400 dark:text-feSecondary-500"},{default:i(()=>[m(l(e.$t("username__fe_valid_description")),1)]),_:1}),a(c,{textColor:"text-feError-500 ",class:"block mt-2"},{default:i(()=>[m(l(e.errors.email),1)]),_:1})]),f("div",de,[a(d,{class:"mb-2",textColor:"text-feSecondary-800 dark:text-feSecondary-200"},{default:i(()=>[m(l(e.$t("core__fe_password")),1)]),_:1}),a(L,{value:e.form.newUser.password,"onUpdate:value":o[3]||(o[3]=t=>e.form.newUser.password=t),ref:"password",placeholderColor:"placeholder-feSecondary-400 dark:placeholder-feSecondary-500",theme:"bg-feAchromatic-50 dark:bg-feSecondary-800",type:e.isHide?"password":"text",onKeyup:o[4]||(o[4]=t=>e.validateEmptyInput("password",e.form.password)),onBlur:o[5]||(o[5]=t=>e.validateEmptyInput("password",e.form.password)),placeholder:e.$t("core__fe_password_placeholder2"),autocomplete:"current-password"},{icon:i(()=>[a(y,{onClick:o[2]||(o[2]=t=>e.isHide=!e.isHide),class:"cursor-pointer",name:e.isHide?"eyeOff":"eye-on"},null,8,["name"])]),_:1},8,["value","type","placeholder"]),a(c,{textColor:"text-feError-500 ",class:"block mt-2"},{default:i(()=>[m(l(e.errors.password),1)]),_:1})]),f("div",pe,[a(r,{class:"w-full mb-2"},{default:i(()=>[e.form.processing?(T(),x(P,{key:0,theme:"border-2 border-t-2 border-text-8 border-t-fePrimary-500 me-1",loadingSize:"h-5 w-5"})):U("",!0),m(" "+l(e.$t("core__fe_btn_done")),1)]),_:1})])],32),m(" "+l(e.authStore.errorMessage),1)])]),_:1})])],2)],64)}var Bo=se(ae,[["render",fe]]);export{Bo as default};
