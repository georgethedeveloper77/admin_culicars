import{aa as B,i as A,ab as u,Q as C,B as I,j as N,k as O,o as E,c as R,b as p,w as T,a as o,E as a,Z as x,l as F,F as q}from"./app.2982e019.js";import H from"./FooterView.722f89eb.js";import M from"./PsNavTabBar.a1e78a20.js";import D from"./PsNavBar.15a584b5.js";import V from"./PsNotificationBox.7fffda98.js";import{A as $}from"./AppInfoParameterHolder.e24d894d.js";import{u as j}from"./AppInfoStore.f8d22516.js";import{P as G}from"./PsValueStore.eb9430a0.js";import{P as K}from"./ps_constants.0e2a11f9.js";import{u as Q}from"./NotificationStore.cd066252.js";import"https://unpkg.com/delayed-scroll-restoration-polyfill@0.1.1/index.js";import{u as W}from"./ThemeStore.40343845.js";import{u as Y}from"./LanguageStore.8f1cddd7.js";import{u as Z}from"./NotificationStore.af68b63a.js";import"./FooterLinkSection.2922917e.js";import"./PsLabel.c51f2c9d.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./PsLink.7aa92bdc.js";import"./PsRouteLink.c57ebe2e.js";import"./PsLabelCaption.54d4aa23.js";import"./PsIcon.515a10c8.js";import"./ProductParameterHolder.4354be0b.js";import"./CustomFieldStore.79b51a65.js";import"./PsApiService.9afc2356.js";import"./PsObject.a17ef38f.js";import"./DefaultPhoto.cc755f93.js";import"./PsStore.6f734180.js";import"./PsSepetetedStore.9a31ac47.js";import"./PsDropdown.2a6cc373.js";import"./PsDropdownSelect.ce61e1c2.js";import"./PsIconToggle.e81615f0.js";import"./PsInputWithLeftIcon.f3f18e1b.js";import"./ItemLocationTownshipStore.fe0ada29.js";import"./ItemLocation.d1b92a80.js";import"./LocationParameterHolder.9e411c2e.js";import"./PsUtils.bbfda905.js";import"./UserStore.cc6d36cc.js";import"./User.0c3ba1a8.js";import"./RatingDetail.291ad5d1.js";import"./ProductRelation.0b376978.js";import"./UserListParameterHolder.d110b747.js";import"./ApiStatus.5720ba0b.js";import"./index.esm.8fcef60c.js";import"./auth.esm.be6b9a90.js";import"./UserUnReadMessageParameterHolder.81a68b74.js";import"./AddToCartStore.71386b4c.js";import"./PsLine.ea3266c0.js";import"./PsButton.7f6705bd.js";import"./index.esm.7ce161a7.js";import"./ProductStore.a3320c3f.js";import"./Phone.45f97258.js";import"./Product.29c94914.js";import"./Category.7c65464b.js";import"./DefaultIcon.e76b39a5.js";import"./SubCategory.1b4176e0.js";import"./ItemCurrency.91c8ce91.js";import"./Vendor.d946ee87.js";import"./UserDeleteItemParameterHolder.5d816aba.js";import"./NotiUnRegisterHolder.eefb692e.js";const z=B("CoreScrollRestorationStore",()=>{const e=A(!0);function t(){"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual"),window.popStateDetected=!1,window.addEventListener("popstate",r=>{r!=null&&r.state!=null&&r.state.url!=null&&(String(r.state.url).includes("item-list",1)||String(r.state.url).includes("active-items",1)||String(r.state.url).includes("other-profile",1))?window.popStateDetected=!0:window.popStateDetected=!1})}function i(){window.addEventListener("scroll",c)}function s(){window.removeEventListener("scroll",c)}function c(){window.pageYOffset>30?e.value&&(e.value=!1):e.value||(e.value=!0)}return{atTopOfPage:e,initStoreRestoration:t,addHandleScrollListener:i,removeHandleScrollListener:s}});let l=[];const J=e=>{const t=u.CancelToken.source();return e.cancelToken=t.token,l.push(t),e},X=e=>(l=l.filter(t=>t.token!==e.config.cancelToken),e),ee=e=>(u.isCancel(e)||(l=l.filter(t=>t.token!==e.config.cancelToken)),Promise.reject(e)),L=()=>{l.forEach(e=>e.cancel("Request canceled by navigation")),l=[]},te=()=>{u.interceptors.request.use(J),u.interceptors.response.use(X,ee)},oe=["href"],re=["href"],ne=["href"],ie=o("link",{rel:"preconnect",href:"https://fonts.googleapis.com"},null,-1),se=o("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossorigin:""},null,-1),ae=["dir"],le={class:"flex flex-col w-full h-full min-h-screen"},pe={class:"flex-grow bg-feAchromatic-50 dark:bg-feAchromatic-900"},ce={class:"fixed top-0"},St={__name:"PsFrontendLayout",setup(e){const{props:t}=C(),i=z(),s=j(),c=W(),r=Y(),U=Q();let f=G();const m=Z();te(),i.initStoreRestoration(),m.initFirebase(t.firebaseConfig),m.requestPermission();const y=new $,d=A(t.authUser?t.authUser.id:K.NO_LOGIN_USER);return f.replaceLoginUserId(d.value),I.on("finish",n=>{m.isUserPresence(route().current())}),N(async()=>{c.initDarkMode(),r.initActiveLangauge(),i.addHandleScrollListener();var n=document.getElementById("home_loading__container");n.style.display="none",m.initMessageServieWorker(t.appUrl,t.webPushKey,f,route("firebase.topicSubscribeForNoti"),s,U,d),y.userId=d.value,s.loadAppInfoProps(t.getAppInfo)}),I.on("start",n=>{console.log("Cancel"),L()}),window.addEventListener("beforeunload",()=>{L()}),O(()=>{i.removeHandleScrollListener()}),(n,me)=>(E(),R(q,null,[p(a(x),null,{default:T(()=>{var g,h,S,w,_,P,v,k,b;return[o("link",{rel:"icon",type:"image/svg+xml",href:n.$page.props.thumb1xUrl+"/"+((S=(h=(g=a(s).appInfo.data)==null?void 0:g.frontendConfigSetting)==null?void 0:h.frontendIcon)==null?void 0:S.imgPath)},null,8,oe),o("link",{rel:"preload",as:"image",href:n.$page.props.thumb1xUrl+"/"+((P=(_=(w=a(s).appInfo.data)==null?void 0:w.frontendConfigSetting)==null?void 0:_.frontendBanner)==null?void 0:P.imgPath)},null,8,re),o("link",{rel:"preload",as:"image",href:n.$page.props.uploadUrl+"/"+((b=(k=(v=a(s).appInfo.data)==null?void 0:v.frontendConfigSetting)==null?void 0:k.frontendBanner)==null?void 0:b.imgPath)},null,8,ne),ie,se]}),_:1}),o("div",{dir:a(r).getLanguageDir(),class:"h-full bg-feAchromatic-50"},[o("div",le,[o("main",pe,[F(n.$slots,"default")]),o("div",ce,[p(M,{topOfPage:a(i).atTopOfPage},null,8,["topOfPage"]),p(D,{topOfPage:a(i).atTopOfPage,uploadSetting:n.$page.props.backendSetting.upload_setting},null,8,["topOfPage","uploadSetting"])]),o("footer",null,[p(H)])])],8,ae),p(V)],64))}};export{St as default};
